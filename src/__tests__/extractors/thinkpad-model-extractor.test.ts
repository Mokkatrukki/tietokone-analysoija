import { extractThinkpadModel } from '../../utils/thinkpadModelExtractor';

describe('ThinkPad Model Extractor', () => {
  describe('extractThinkpadModel', () => {
    it('should return null for non-ThinkPad descriptions', () => {
      expect(extractThinkpadModel('Dell XPS 13 laptop for sale')).toBeNull();
      expect(extractThinkpadModel('HP Pavilion gaming laptop')).toBeNull();
      expect(extractThinkpadModel('MacBook Pro 16 inch')).toBeNull();
    });

    describe('T-series models', () => {
      it('should extract T480 model', () => {
        expect(extractThinkpadModel('Lenovo ThinkPad T480 laptop for sale')).toBe('T480');
      });

      it('should extract T490s model', () => {
        expect(extractThinkpadModel('ThinkPad T490s with 16GB RAM')).toBe('T490S');
      });

      it('should extract T14 model', () => {
        expect(extractThinkpadModel('Selling my ThinkPad T14 laptop')).toBe('T14');
      });

      it('should extract T14 with generation', () => {
        expect(extractThinkpadModel('ThinkPad T14 Gen 2 (Intel) laptop')).toBe('T14 GEN 2');
      });
    });

    describe('X-series models', () => {
      it('should extract X280 model', () => {
        expect(extractThinkpadModel('Lenovo ThinkPad X280 ultrabook')).toBe('X280');
      });

      it('should extract X1 Carbon model', () => {
        expect(extractThinkpadModel('ThinkPad X1 Carbon laptop')).toBe('X1C');
      });

      it('should extract X1 Carbon with generation', () => {
        expect(extractThinkpadModel('ThinkPad X1 Carbon Gen 6 ultrabook')).toBe('X1C GEN 6');
      });

      it('should extract X1 Carbon from X1C abbreviation', () => {
        expect(extractThinkpadModel('ThinkPad X1C Gen 7 laptop')).toBe('X1C GEN 7');
      });

      it('should extract X1 Yoga model', () => {
        expect(extractThinkpadModel('ThinkPad X1 Yoga convertible laptop')).toBe('X1 YOGA');
      });

      it('should extract X1 Yoga with generation', () => {
        expect(extractThinkpadModel('ThinkPad X1 Yoga Gen 4 2-in-1')).toBe('X1 YOGA GEN 4');
      });
    });

    describe('P-series models', () => {
      it('should extract P52 model', () => {
        expect(extractThinkpadModel('Lenovo ThinkPad P52 workstation')).toBe('P52');
      });

      it('should extract P1 model', () => {
        expect(extractThinkpadModel('ThinkPad P1 mobile workstation')).toBe('P1');
      });

      it('should extract P1 with generation', () => {
        expect(extractThinkpadModel('ThinkPad P1 Gen 3 laptop')).toBe('P1 GEN 3');
      });
    });

    describe('L-series models', () => {
      it('should extract L380 model', () => {
        expect(extractThinkpadModel('Lenovo ThinkPad L380 business laptop')).toBe('L380');
      });

      it('should extract L13 model', () => {
        expect(extractThinkpadModel('ThinkPad L13 laptop for sale')).toBe('L13');
      });

      it('should extract L13 Yoga model', () => {
        expect(extractThinkpadModel('ThinkPad L13 Yoga 2-in-1 laptop')).toBe('L13');
      });
    });

    describe('E-series models', () => {
      it('should extract E480 model', () => {
        expect(extractThinkpadModel('Lenovo ThinkPad E480 budget laptop')).toBe('E480');
      });

      it('should extract E14 model', () => {
        expect(extractThinkpadModel('ThinkPad E14 laptop for students')).toBe('E14');
      });

      it('should extract E14 with generation and processor', () => {
        expect(extractThinkpadModel('ThinkPad E14 Gen 2 (AMD) laptop')).toBe('E14 GEN 2');
      });
    });

    describe('Other series and special cases', () => {
      it('should extract W540 model', () => {
        expect(extractThinkpadModel('Lenovo ThinkPad W540 workstation')).toBe('W540');
      });

      it('should extract Yoga 370 model', () => {
        expect(extractThinkpadModel('ThinkPad Yoga 370 convertible')).toBe('YOGA 370');
      });

      it('should extract Helix model', () => {
        expect(extractThinkpadModel('ThinkPad Helix 2-in-1 tablet')).toBe('HELIX');
      });

      it('should extract X1 Extreme model', () => {
        expect(extractThinkpadModel('ThinkPad X1 Extreme gaming laptop')).toBe('X1 EXTREME');
      });

      it('should extract X1 Extreme with generation', () => {
        expect(extractThinkpadModel('ThinkPad X1 Extreme Gen 2 with GTX 1650')).toBe('X1 EXTREME GEN 2');
      });
    });

    describe('Real-world examples', () => {
      it('should extract X280 from a complex description', () => {
        const description = 'Siistikuntoinen ja t√§ysin toimiva.Pieni√§ k√§yt√∂nj√§lki√§ l√∂ytyy mutta toimii kuin pit√§√§kin. 12.5" LENOVO THINPAD X280 Intel i5 Full HD 1920√ó1080 IPSUltrabook Business Laptop 256GB SSD| 8GB RAM| HDMI | 4G SIM WINDOWS 11 Pro Intel Core i5@8250U 1920√ó1080UHD Graphics 620 UHD IPS- 8GB RAM- 256GB SSD  - 1 √ó HDMI, 3 x USB 4G SIM CARDMore than 8hours battery lifeüîã + Microsoft office + Adobe Reader';
        expect(extractThinkpadModel(description)).toBe('X280');
      });

      it('should extract T460s from a Finnish description', () => {
        const description = 'Myyd√§√§n Lenovo Thinkpad T460s kannettava tietokone. Mukaan laturi. Malli T460s i5 B1S2F\nN√§ytt√∂ 14\nProsessori: Intel Core i5-6300U\nMuisti: 8 Gt\nKiintolevy: 256 Gt ssd\nWindows 11';
        expect(extractThinkpadModel(description)).toBe('T460S');
      });
      
      it('should extract T14s Gen 2 from a detailed Finnish description', () => {
        const description = 'KuvausT14s G2 kuuluu Lenovon laadukkaaseen ThinkPad yritysmallistoon. S-mallit ovat perinteisi√§ Thinkpadeja ohuempia ja kevyempi√§ tinkim√§tt√§ kuitenkaan kest√§vyydest√§ tai nopeak√§ytt√∂isyydest√§.\nKoneen kattavaan varusteluun kuuluvat mm tasokas Full HD IPS-n√§ytt√∂, modernit liit√§nn√§t, eritt√§in vankka mutta kevyt rakenne, sek√§ taustavalaistu n√§pp√§imist√∂.\nT14s yhdist√§√§ tinkim√§tt√∂m√§n suorituskyvyn ja kest√§vyyden laadukkaaseen ja kompaktiin pakettiin, joka sopii niin tien p√§√§lle ty√∂teht√§viin, kuin vaativampiin opintoihinkin.\nT√§m√§ kyseinen kone on mallinsa paremmin varusteltu yksil√∂ sis√§lt√§en mm tehokkaamman 11. sukupolven i5 vPro-prosessorin, 16GB DDR4 keskusmuistia, nopeak√§ytt√∂isen 512GB m.2 NVMe SSD-levyn, sek√§ sis√§√§nrakennetun 4G-modeemin.\nPitk√§ll√§ takuulla varustettua huippuluokan yrityskannettavaa hieman vaativammallekin k√§ytt√§j√§lle!\nKunto: A, normaalia kulumaa koneen kannessa, yleisilme siisti, n√§ytt√∂ virheet√∂n.\nMalli: Lenovo ThinkPad T14s G2\nAkku: ~6-8h+ k√§yt√∂st√§ riippuen\nK√§ytt√∂j√§rjestelm√§: Windows 11 Pro\nN√§ytt√∂: 14 tuumaa Full HD 1920x1080p IPS-paneeli, heijastamaton\nProsessori: Intel Core i5-1145G7 vPro 4C/8T @ 2.50-4.30GHz\nKeskusmuisti: 16GB DDR4\nSSD-Levy: 512GB m.2 PCIe NVMe\nN√§ytt√∂liit√§nn√§t: 2xUSB-C/Thunderbolt 4, HDMI\nLiit√§nn√§t: 2xUSB3, 2xUSB-C, Kuuloke/Mic\nVerkkoyhteys: Wifi, Bluetooth, 4G/LTE\nRoiskesuojattu ja taustavalaistu n√§pp√§imist√∂\nTakuu: 18 kuukautta\nHinta sis√§lt√§√§ arvonlis√§veron 25,5%.\nTietokoneeseen on asennettu Windows 11 Pro p√§ivityksineen sek√§ perusohjelmat k√§ytt√∂√§ varten kuten nettiselaimet, ilmainen toimisto-ohjelmistopaketti sek√§ ohjelmat mediatoistoa varten. Tietokone on t√§ysin huollettu sek√§ testattu ja on heti k√§ytt√∂valmis.\nMeille voit my√∂s j√§tt√§√§ vanhat tietokoneet ja niiden oheislaitteet kierr√§tett√§v√§ksi.';
        expect(extractThinkpadModel(description)).toBe('T14S GEN 2');
      });
      
      it('should extract T14s Gen 2 from a title', () => {
        const title = 'Lenovo T14s G2 [i5-1145G7/16GB/512GB/LTE] 18kk Takuu';
        expect(extractThinkpadModel(title)).toBe('T14S GEN 2');
      });
      
      it('should extract L14 Gen 2 from a detailed Finnish description', () => {
        const description = 'KuvausLinkki verkkokauppaamme t√§h√§n koneeseen:\nhttps://itkeskus.fi/tuote/lenovo-thinkpad-l14-gen2-i5-1135g7-8gb-256gb-kannettava-tietokone/?utm_source=tori&utm_medium=linkki&utm_campaign=ilmotukset\nHyvin huollettuna k√§ytetty tietokone on erinomainen valinta. Tietokoneet ovat p√§√§s√§√§nt√∂isesti melko huoltovapaita laitteita, mutta k√§ytetty√§ konetta ostaessasi kannattaa varmistaa, ett√§ tietyt huollot ovat tehty. Muuten koneen tarina voi j√§√§d√§ lyhyeksi. N√§ist√§ huolloista on kerrottu lis√§√§ blogissamme, joka l√∂ytyy t√§√§lt√§ https://itkeskus.fi/2024/10/07/miksi-ostaa-kaytetty-tietokone-meilta/?utm_source=tori&utm_medium=linkki&utm_campaign=blogi\nEmme pid√§ reklamaatioista. Siksi myym√§mme koneet k√§yv√§t l√§pi laajan 7-osaisen huolto-ohjelman. Haluamme, ett√§ kone kest√§√§ k√§yt√∂ss√§si mahdollisimman pitk√§√§n. Siit√§ hy√∂tyv√§t kaikki: sin√§ (suurempi k√§ytt√∂arvo), me (olet tyytyv√§inen asiakas) ja ymp√§rist√∂ (v√§hemm√§n kulutettuja luonnonvaroja). N√§iden syiden vuoksi myym√§mme koneet ovat t√§ysin huollettuja.\nLenovo ThinkPad L14 Gen 2 on kannettava, joka tuo luotettavuutta ja joustavuutta jokaisen ty√∂p√§iv√§n tarpeisiin. Sen kest√§v√§ rakenne ja huipputason suorituskyky ovat omiaan yritysk√§ytt√∂√∂n ja liikkuvaan ty√∂skentelyyn. Riippumatta siit√§, oletko toimistolla vai tien p√§√§ll√§, ThinkPad L14 Gen 2 pit√§√§ huolen, ett√§ pysyt tuottavana ja yhteydess√§.\nKone on t√§ysin valmis k√§ytt√∂√∂n. K√§ytt√§j√§ on valmiiksi luotu. Asennettu Google Chrome, Mozilla Firefox ja Acrobat Reader, jotta koneen k√§ytt√∂√∂notto on helpompaa.\nPoikkeuksena verrattuna moniin muihin k√§ytettyjen tietokoneiden myyjiin, annamme my√∂s akulle vuoden takuun.\nAkku:\nAkun kapasiteetti uuteen verrattuna 85 %. 4-kennoinen 45 Wh Litiumioniakku. RapidCharge-tuki noin 80 % latausta tunnissa.\nTekniset tiedot:\nN√§ytt√∂: 14\'\' 1920 x 1080, FullHD, heijastamaton IPS-paneeli\nK√§ytt√∂j√§rjestelm√§: Windows 11 Pro\nProsessori: Intel Core i5-1135G7 (4-ydin, 2.4 GHz, Turbo 4.2 GHz, 8 Mb v√§limuisti)\nKeskusmuisti: 8 GB DDR4 3200 MHz (2 x SO-DIMM-paikkaa, maksimikapasiteetti 64 GB)\nN√§yt√∂nohjain: Intel Iris Xe Graphics\nKovalevy: Toshiba 256 GB NVMe SSD\nMikrofoni: Kyll√§\nKaiuttimet: Kyll√§, Dolby Audio\nWeb-kamera: Kyll√§ 720p HD\nLangaton verkkoyhteys: Kyll√§, Wi-Fi 6 802.11ax\nBluetooth: Kyll√§, Bluetooth 5.1\nMuut ominaisuudet: TPM 2.0, Windows Hello -kasvojentunnistus, sormenj√§lkilukija, ThinkShutter -kameransuojus, taustavalaistu n√§pp√§imist√∂\nLiit√§nn√§t:\nN√§ytt√∂: 1 x HDMI 2.0\nUSB: 2 x USB 3.2 Gen1 Type-C (1 x PowerDelivery ja Displayport 1.4/Thunderbolt 4)\n√Ñ√§ni: 3.5 mm kuulokemikrofoniliit√§nt√§\nMuut: MicroSD-kortinlukija, RJ45 Ethernet, SmartCard -lukija\nPaino: 1,74 kg\nMitat: 33,1 x 23,5 x 2,04 cm\nTakuu:\n12 kk, koskee my√∂s akkua\nLis√§tietoa meist√§: https://tampereentietokoneapu.fi/meista/\nLinkki verkkokauppaamme t√§h√§n koneeseen:\nhttps://itkeskus.fi/tuote/lenovo-thinkpad-l14-gen2-i5-1135g7-8gb-256gb-kannettava-tietokone/?utm_source=tori&utm_medium=linkki&utm_campaign=ilmotukset\nHakusanat:\nyritysl√§pp√§ri, yrityskone, k√§ytetty tietokone, tietokone, laptop, tietokone, kannettava tietokone, l√§pp√§ri, business laptop';
        expect(extractThinkpadModel(description)).toBe('L14 GEN 2');
      });
      
      it('should extract L14 Gen 2 from a title', () => {
        const title = 'Lenovo ThinkPad L14 Gen2 i5-1135G7/8GB/256GB kannettava tietokone, HUOLLETTU';
        expect(extractThinkpadModel(title)).toBe('L14 GEN 2');
      });


      it('should extract L14 Gen 1 from a title', () => {
        const title = 'Lenovo ThinkPad L14 Gen1 i5-1135G7/8GB/256GB kannettava tietokone, HUOLLETTU';
        expect(extractThinkpadModel(title)).toBe('L14 GEN 1');
      });
    });
  });
}); 